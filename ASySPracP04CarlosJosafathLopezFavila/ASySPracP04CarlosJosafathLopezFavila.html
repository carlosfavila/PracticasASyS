
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>P04: Convoluci&oacute;n y Correlaci&oacute;n de se&ntilde;ales</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-06-14"><meta name="DC.source" content="ASySPracP04CarlosJosafathLopezFavila.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1><b>P04: Convoluci&oacute;n y Correlaci&oacute;n de se&ntilde;ales</b></h1><!--introduction--><p><b>INTEGRANTES:</b></p><div><ul><li>Carlos Josafath L&oacute;pez Favila</li><li>Iv&aacute;n Rodrigo Santacruz Bravo</li></ul></div><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1"><b>OBJETIVOS</b></a></li><li><a href="#2"><b>INTRODUCCI&Oacute;N</b></a></li><li><a href="#14">Punto 1: Ejercicio 1 de la PR04</a></li><li><a href="#23">Punto 2: Ejercicio e) de la PR05</a></li><li><a href="#30">Punto 3 Convoluci&oacute;n de las se&ntilde;ales (c) con (d) del problema 3.1-1</a></li><li><a href="#36">Punto 4 Correlacion de las se&ntilde;ales (c) con (d) del problema 3.1-1</a></li><li><a href="#42">Punto 5 Convolucion de las se&ntilde;ales (c) con (d) del problema 3.1-1 usando CONV</a></li><li><a href="#43">Ap&eacute;ndices</a></li></ul></div><h2 id="1"><b>OBJETIVOS</b></h2><div><ul><li>Conocer m&eacute;todos b&aacute;sicos de integraci&oacute;n num&eacute;rica</li><li>Manipulaci&oacute;n de instrucciones en MATLAB</li><li>Simular convoluciones y correlaciones de se&ntilde;ales continuas</li><li>Simular convoluciones y correlaciones de se&ntilde;ales discretas</li></ul></div><h2 id="2"><b>INTRODUCCI&Oacute;N</b></h2><p><b>M&egrave;todos Num&egrave;ricos</b> Cuando aplicamos la teoria del calculo en la realidad se pueden dar casos donde se tengan problemas cuya solucion no pueda ser encontrada por alguna formula o m&egrave;todo del calculo, es por ello que los matematicos se dieron a la tarea de desarrollar los <b>m&eacute;todos num&eacute;ricos.</b> Se trata de una serie de c&aacute;lculos para acercarnos lo m&aacute;s posible a una soluci&oacute;n num&eacute;rica con una precisi&oacute;n razonablemente buena. Los <b>m&eacute;todos num&eacute;ricos</b> son utilizados en ingenier&iacute;a para facilitar la resoluci&oacute;n de problemas que conllevan una enorme cantidad de c&aacute;lculos, lo que permite ahorrar tiempo.</p><p><b>Teorema fundamental del C&aacute;lculo</b></p><p>El teorema dice asi "Si f(x) es integrable y <img src="ASySPracP04CarlosJosafathLopezFavila_eq14100899522541693629.png" alt="$\frac{\mathrm{d} F(x)}{\mathrm{d} x}=f(x)$"> entonces:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq16817905199163689891.png" alt="$$\int_{a}^{b}f(x)dx=F(b)-F(a)$$"></p><p>En este m&egrave;todo se centra en encontrar aproximaciones a integrales de funciones que no son posibles de resolver por algun m&egrave;todo conocido, como por ejemplo:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq00601181232412590670.png" alt="$$f(x)= e^{-x^{2}}$$"></p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq07964293655954872043.png" alt="$$\int_{-1}^{1} f(x)dx=\int_{-1}^{1}e^{-x^{2}}dx$$"></p><pre class="codeinput">syms <span class="string">t</span>;
ft = exp(-t^2);
fplot(ft);
title(<span class="string">'f(t)'</span>);
grid <span class="string">on</span>
clear ;
clc;
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_01.png" alt=""> <p>Como no es posible encontrar F(x) entonces se procede a hacer una aproximacion con un polinomio</p><p>Con P(x)=1                    entonces <img src="ASySPracP04CarlosJosafathLopezFavila_eq18320428117033228560.png" alt="$\int_{-1}^{1}P(x)dx=\int_{-1}^{1}1dx=2$"></p><p>Tenemos la siguiente Gr&agrave;fica</p><p><img vspace="5" hspace="5" src="P04_1.jpeg" alt=""> </p><p>Donde el &agrave;rea sobreada de color naraja es el &agrave;rea de P(x) y el &agrave;rea en color verde seria el &agrave;rea de f(x)</p><p>Teniendo esto podemos decir con seguiridad que <img src="ASySPracP04CarlosJosafathLopezFavila_eq08017921094228021135.png" alt="$\int_{-1}^{1}e^{-x^{2}}dx<2$"></p><p>Y podemos dividir el rect&agrave;ngulo generado por el area de P(x) en 4 y hacer una aproximacion mas acertada <img src="ASySPracP04CarlosJosafathLopezFavila_eq10833033803452336156.png" alt="$\int_{-1}^{1}e^{-x^{2}}dx\approx 1.4936$"></p><p><b>*F&ograve;rmulas Cerradas de Newton-Cotes</b>*</p><p>En este m&egrave;todo se utilizan los polinomios de interpolacion de Lagrange para determinar <img src="ASySPracP04CarlosJosafathLopezFavila_eq11518683629591826499.png" alt="$\int_{a}^{b}f(x)dx$"></p><p>Establece que <img src="ASySPracP04CarlosJosafathLopezFavila_eq09346620932442712113.png" alt="$f(x)^{n+1}\epsilon [a,b]$"> existe <img src="ASySPracP04CarlosJosafathLopezFavila_eq03156822370926593941.png" alt="$\varepsilon (x)\epsilon[a,b]$"></p><p>Donde f(x) se puede escribir como:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq12368147126434596011.png" alt="$$f(x)=P_{n}(x)+\frac{f(x)^{n+1}(\varepsilon(x))}{(n+1)!}(x-x_{0})(x-x_{1})...(x-x_{n})$$"></p><p>Donde <img src="ASySPracP04CarlosJosafathLopezFavila_eq11785513331722918353.png" alt="$P_{n}$"> seria una aproximacion a la funcion mas un termino de error , <img src="ASySPracP04CarlosJosafathLopezFavila_eq01056269978726897643.png" alt="$x_{0}=a$">, <img src="ASySPracP04CarlosJosafathLopezFavila_eq00331310322815514266.png" alt="$x_{n}=b$">, <img src="ASySPracP04CarlosJosafathLopezFavila_eq07185229180791245808.png" alt="$x_{n}=a$">, <img src="ASySPracP04CarlosJosafathLopezFavila_eq14663764134541110566.png" alt="$h=\frac{b-a}{n}$">, <img src="ASySPracP04CarlosJosafathLopezFavila_eq01242584725144056296.png" alt="$x_{i}=a+ih$">, <img src="ASySPracP04CarlosJosafathLopezFavila_eq17180262577933120381.png" alt="$i= 0,1,...,n$"> , <img src="ASySPracP04CarlosJosafathLopezFavila_eq08984225997457563733.png" alt="$n$"> es el grado del polinomio</p><p>Para que de este modo en lugar de determinar la integral de f(x), se hace una aproximacion por medio de los polinomios de lagrange</p><p><b>Regla del trapecio</b></p><p>Este m&egrave;todo es el m&egrave;todo de Newton-Cotes para un valor de <img src="ASySPracP04CarlosJosafathLopezFavila_eq16789844994363566909.png" alt="$n=1$"> que nos da la siguiente f&ograve;rmula:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq12375842695603031330.png" alt="$$\int_{x_{0}}^{x_{1}}f(x)dx= \frac{h}{2}[f(x_{0})+f(x_{1})]-\frac{h^{3}}{12}f^{''}(\varepsilon )$$"></p><p>Donde <img src="ASySPracP04CarlosJosafathLopezFavila_eq16618907545761072854.png" alt="$x_{0}<\varepsilon <x_{1}$"></p><p>Retomando el ejemplo anterior</p><p>Para Resolver <img src="ASySPracP04CarlosJosafathLopezFavila_eq07284837041229820729.png" alt="$\int_{-1}^{1} e^{-x^{2}}dx$"></p><p>se tiene que <img src="ASySPracP04CarlosJosafathLopezFavila_eq01658482534070209166.png" alt="$$\int_{-1}^{1}e^{-x^{2}}dx= \frac{2}{2}[e^{-1}+e^{-1}]-\frac{8}{12}f^{''}(\varepsilon )$"></p><pre class="codeinput">syms <span class="string">t</span> <span class="string">E</span>
ft=exp(-t^2);
d2ft=diff(ft,2);
FT=matlabFunction(ft);
n=1;
a=-1;
b=1;
x0=a;
x1=b;
h=(b-a)/n;
i=0:1:n;
xi=a+i*h;
int=(h/2)*(FT(x0)+FT(x1))
INT=round(int,4)-((h^3)/12)*subs(d2ft,t,E)
clc;
clear;
</pre><pre class="codeoutput">
int =

    0.7358

 
INT =
 
(4*exp(-E^2))/3 - (8*E^2*exp(-E^2))/3 + 3679/5000
 
</pre><p>Donde se tiene que <img src="ASySPracP04CarlosJosafathLopezFavila_eq00017302693956349038.png" alt="$-\frac{8}{12}f^{''}(\varepsilon )$"> es el t&egrave;rmino de error que se debe de sumar o restar a la aproximacion con <img src="ASySPracP04CarlosJosafathLopezFavila_eq14299477224450240299.png" alt="$-1<\varepsilon <1$"></p><p><b>Regla de Simpson</b></p><p>Cuando se tiene que n=2 en el m&egrave;todo de Newton-Cotes se le denomina Regla de Simpson</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq15117592300319617854.png" alt="$$\int_{x_{0}}^{x_{2}}f(x)dx= \frac{h}{3}[f(x_{0})+4f(x_{1})+f(x_{2})]-\frac{h^{5}}{90}f^{4'}(\varepsilon$$"></p><p>Donde   <img src="ASySPracP04CarlosJosafathLopezFavila_eq02438704613684864715.png" alt="$x_{0}<\varepsilon <x_{2}$"></p><p>Aplicando la Regla de simpson para encontrar la aproximaci&oacute;n de <img src="ASySPracP04CarlosJosafathLopezFavila_eq08619110315139853428.png" alt="$\int_{-1}^{1}e^{-x^{2}}dx$"></p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq16114595293879640422.png" alt="$$\int_{-1}^{1}e^{-x^{2}}dx= \frac{h}{3}[e^{-1}+4e^{0}+e^{-1}]-\frac{32}{90}f^{4'}(\varepsilon)$$"></p><pre class="codeinput">syms <span class="string">t</span> <span class="string">E</span>
ft=exp(-t^2);
d2ft=diff(ft,4);
FT=matlabFunction(ft);
n=2;
a=-1;
b=1;
h=(b-a)/n;
i=0:1:n;
I=length(i);
x0=a;
x1=a+(h*i(I-1));
x2=b;
int=(h/3)*(FT(x0)+4*FT(x1)+FT(x2))
INT=round(int,4)-((h^5)/90)*subs(d2ft,t,E)
clear;
clc;
</pre><pre class="codeoutput">
int =

    1.5786

 
INT =
 
(8*E^2*exp(-E^2))/15 - (2*exp(-E^2))/15 - (8*E^4*exp(-E^2))/45 + 7893/5000
 
</pre><p>Donde se tiene que <img src="ASySPracP04CarlosJosafathLopezFavila_eq08940378589790010592.png" alt="$-\frac{32}{90}f^{4'}(\varepsilon)$"> es el t&egrave;rmino de error que se debe de sumar o restar a la aproximaci&oacute;n con <img src="ASySPracP04CarlosJosafathLopezFavila_eq14299477224450240299.png" alt="$-1<\varepsilon <1$"></p><p><b>Regla de 3/8 de Simpson</b></p><p>Cuando de realiza una interpolacion para obtener una aproximacion con un polinomio de 3er grado se le llama como regla de 3/8 de Simpson que nos da la siguiente f&ograve;rmula</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq08620801856754852052.png" alt="$$\int_{x_{0}}^{x_{3}}f(x)dx= \frac{3}{8}h[f(x_{0})+3f(x_{1})+3f(x_{2})+f(x_{3})]-\frac{3h^{5}}{80}f^{4'}(\varepsilon)$$"></p><p>Donde   <img src="ASySPracP04CarlosJosafathLopezFavila_eq02205504026367631584.png" alt="$x_{0}<\varepsilon <x_{3}$"></p><p>Aplicando la Regla de simpson para encontrar la aproximacion de <img src="ASySPracP04CarlosJosafathLopezFavila_eq08619110315139853428.png" alt="$\int_{-1}^{1}e^{-x^{2}}dx$"> se tiene:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq14473108363797803489.png" alt="$$\int_{-1}^{1}e^{-x^{2}}dx=\frac{3}{8}\frac{2}{3}[e^{-1}+3e^{-\frac{1}{9}}+3e^{-\frac{1}{9}}+e^{-1}]-\frac{3(\frac{2}{3})^{5}}{80}f^{4'}(\varepsilon)$$"></p><pre class="codeinput">syms <span class="string">t</span> <span class="string">E</span>
ft=exp(-t^2);
d2ft=diff(ft,4);
FT=matlabFunction(ft);
n=3;
a=-1;
b=1;
h=(b-a)/n;
i=0:1:n;
I=length(i);
x0=a;
x1=a+(h*i(I-1));
x2=a+(h*i(I-2));
x3=b;
int=((3*h)/8)*(FT(x0)+3*FT(x1)+3*FT(x2)+FT(x3))
INT=round(int,4)-((3*(h^5))/80)*subs(d2ft,t,E)
clear
clc;
</pre><pre class="codeoutput">
int =

    1.5262

 
INT =
 
(32*E^2*exp(-E^2))/135 - (8*exp(-E^2))/135 - (32*E^4*exp(-E^2))/405 + 7631/5000
 
</pre><p>Donde se tiene que <img src="ASySPracP04CarlosJosafathLopezFavila_eq05085968187014977519.png" alt="$-\frac{3(\frac{2}{3})^{5}}{80}f^{4'}(\varepsilon)$"> es el t&egrave;rmino de error que se debe de sumar o restar a la aproximacion con <img src="ASySPracP04CarlosJosafathLopezFavila_eq14299477224450240299.png" alt="$-1<\varepsilon <1$"></p><p><b>Regla del trapecio compuesta</b></p><p>La idea de este metodo es dividir el intervalo principal en <img src="ASySPracP04CarlosJosafathLopezFavila_eq08984225997457563733.png" alt="$n$"> intervalos para obtener una mejor aproximacion</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq14697006813916262459.png" alt="$$\int_{a}^{b}f(x)dx= \frac{h}{2}[f(a)+2\sum_{j=1}^{n-1}f(x_{j})+f(b)]-\frac{{b-a}}{12}h^{2}f^{''}(\mu)$$"></p><p>Donde <img src="ASySPracP04CarlosJosafathLopezFavila_eq16623451632674213235.png" alt="$\mu\epsilon [a,b]$">, <img src="ASySPracP04CarlosJosafathLopezFavila_eq14663764134541110566.png" alt="$h=\frac{b-a}{n}$">, <img src="ASySPracP04CarlosJosafathLopezFavila_eq08984225997457563733.png" alt="$n$"> es el n&ugrave;mero de subintervalos, <img src="ASySPracP04CarlosJosafathLopezFavila_eq06650310548822328320.png" alt="$x_{j}=a+jh$">  y <img src="ASySPracP04CarlosJosafathLopezFavila_eq03844387587557850307.png" alt="$j=1,2,3,...,n$"></p><p>EJEMPLO</p><p>Retomando el ejercicio inicial y realizando 10 subintervalos tenemos que:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq04906614860200194095.png" alt="$$\int_{-1}^{1}e^{-x^{2}}dx=\frac{0.2}{2}[e^{-1}+2\sum_{j=1}^{9}e^{-x_{j}^{2}}+e^{-1}]-\frac{2}{12}(0.2)^{2}f^{''}(\mu)$$"></p><pre class="codeinput">syms <span class="string">t</span> <span class="string">u</span>
ft=exp(-t^2);
d2ft=diff(ft,2);
FT=matlabFunction(ft);
n=10;
a=-1;
b=1;
j=1:(n-1);
h=(b-a)/n;
xj=a+(j*h);
int= (h/2)*(FT(a)+2*sum(FT(xj))+FT(b))
INT= round(int,4)-((b-a)/12)*(h^2)*subs(d2ft,t,u)
clear
clc
</pre><pre class="codeoutput">
int =

    1.4887

 
INT =
 
exp(-u^2)/75 - (2*u^2*exp(-u^2))/75 + 14887/10000
 
</pre><p>Donde <img src="ASySPracP04CarlosJosafathLopezFavila_eq17094650287530036232.png" alt="$-\frac{2}{12}(0.2)^{2}f^{''}(\mu)$"> es el t&egrave;rmino de error y <img src="ASySPracP04CarlosJosafathLopezFavila_eq03377860824934902109.png" alt="$-1<\mu<1$"></p><p><b>Regla de Simpson compuesta</b></p><p>Es la misma idea de la regla de simpson pero con el formato de la regla del trapecio compuesta (dividir en subintervalos)</p><p>Pero con la condicion de que el n&ugrave;mero de subintervalos sea par teniendo asi lo siguiente:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq12091319815719879344.png" alt="$\int_{a}^{b}f(x)dx= \frac{h}{3}[f(a)+2\sum_{j=1}^{\frac{n}{2}-1}f(x_{2j})+4\sum_{j=1}^{\frac{n}{2}}f(x_{2j-1})+f(b)]-\frac{{b-a}}{180}h^{4}f^{4'}(\mu)$"></p><p>Donde <img src="ASySPracP04CarlosJosafathLopezFavila_eq16623451632674213235.png" alt="$\mu\epsilon [a,b]$">, <img src="ASySPracP04CarlosJosafathLopezFavila_eq14663764134541110566.png" alt="$h=\frac{b-a}{n}$">, <img src="ASySPracP04CarlosJosafathLopezFavila_eq08984225997457563733.png" alt="$n$"> es el n&ugrave;mero de subintervalos, <img src="ASySPracP04CarlosJosafathLopezFavila_eq06650310548822328320.png" alt="$x_{j}=a+jh$">  y <img src="ASySPracP04CarlosJosafathLopezFavila_eq03844387587557850307.png" alt="$j=1,2,3,...,n$"> EJEMPLO</p><p>Retomando el ejercicio inicial y realizando 10 subintervalos tenemos que:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq16418358635007846227.png" alt="$$\int_{-1}^{1}e^{-x^{2}}dx=\frac{0.2}{3}[e^{-1}+2\sum_{j=1}^{4}e^{-x_{2j}^{2}}+4\sum_{j=1}^{5}e^{-x_{2j-1}^{2}})+e^{-1}]-\frac{2}{180}(0.2)^{4}f^{4'}(\mu)$$"></p><pre class="codeinput">syms <span class="string">t</span> <span class="string">u</span>
ft=exp(-t^2);
d2ft=diff(ft,4);
FT=matlabFunction(ft);
n=10;
a=-1;
b=1;
ji=1:2:(n-1);
jp=2:2:(n-1);
h=(b-a)/n;
xjp=a+(jp*h);
xji=a+(ji*h);
int= (h/3)*(FT(a)+2*sum(FT(xjp))+4*sum(FT(xji))+FT(b))
INT= round(int,4)-((b-a)/180)*(h^2)*subs(d2ft,t,u)
</pre><pre class="codeoutput">
int =

    1.4937

 
INT =
 
(8*u^2*exp(-u^2))/375 - (2*exp(-u^2))/375 - (8*u^4*exp(-u^2))/1125 + 14937/10000
 
</pre><p>Donde <img src="ASySPracP04CarlosJosafathLopezFavila_eq02303107010965338526.png" alt="$-\frac{2}{180}(0.2)^{4}f^{4'}(\mu)$"> es el t&egrave;rmino de error y <img src="ASySPracP04CarlosJosafathLopezFavila_eq03377860824934902109.png" alt="$-1<\mu<1$"></p><p><b>Cuadratura Gaussiana</b></p><p>En este m&egrave;todo se usa los polinomios de legendre para encontrar una aproximacion a la integral en un valor determinado de tal manera que:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq15442326724484394397.png" alt="$$\int_{a}^{b}f(x)dx\approx \sum_{i=1}^{n} C_{i}f(x_{i})$$"></p><p>Donde <img src="ASySPracP04CarlosJosafathLopezFavila_eq06343707454480523053.png" alt="$C_{i}$"> son las raices del polinomio de,Legendre</p><p>Los polinomios de legendre estan definidos como:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq17352723602044808364.png" alt="$$P_{n}(t)=\frac{1}{n!2^{n}}\frac{\mathrm{d^{n}} }{\mathrm{d}t^{n}}(t^{2}-1)^{n}$$"></p><p>Y la formula se reduce a la suma de la funcion evaluada en en coeficiente de legendre multiplicado por las raices del polinomio al que se aproximo</p><p><img vspace="5" hspace="5" src="P04_2.jpeg" alt=""> </p><p>EJEMPLO Si se quiere encontrar <img src="ASySPracP04CarlosJosafathLopezFavila_eq08619110315139853428.png" alt="$\int_{-1}^{1}e^{-x^{2}}dx$"> con una aproximacion al polinomio de legendre de grado 2 entonces:</p><pre class="codeinput">syms <span class="string">t</span>
ft=exp(-t^2);
FT=matlabFunction(ft);
Cnj=[1,1];
rnj=[0.5773502692,-0.5773502692];
Frnj=FT(rnj);
Aprox=sum(Cnj.*Frnj)
clear
clc;
</pre><pre class="codeoutput">
Aprox =

    1.4331

</pre><pre class="codeinput"><span class="comment">%Si se quiere encontrar $\int_{-1}^{1}e^{-x^{2}}dx$ con una aproximacion</span>
<span class="comment">% al polinomio de legendre de grado 3 entonces:</span>
<span class="comment">%</span>
syms <span class="string">t</span>
ft=exp(-t^2);
FT=matlabFunction(ft);
rnj=[0.7745966692,0,-0.7745966692];
Cnj=[0.55555555555556,0.888888888889,0.55555555555556];
Frnj=FT(rnj);
Aprox=sum(Cnj.*Frnj)
clear
clc;
</pre><pre class="codeoutput">
Aprox =

    1.4987

</pre><h2 id="14">Punto 1: Ejercicio 1 de la PR04</h2><p>Para el PR04 reporte la grafica de la simulaci&oacute;n n&uacute;merica de la convoluci&oacute;n y compare con el resultado an&aacute;litico que obtuvo para el problema 1, esto es, su pr&aacute;ctica tendr&aacute; que incluir una llamada a la funci&oacute;nn convconm y posteriormente se tendr&aacute; que mostrar (mediante el Publish) la gr&aacute;fica tanto de las se&ntilde;ales involucradas como el resultado de la convoluci&oacute;n, y en esta &uacute;ltima gr&aacute;ficara su resultado analitico, se tendr&aacute; que incluir el resultado analitico. Realizamos la convoluci&oacute;n de dos se&ntilde;ales:</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq02301697894531411322.png" alt="$$f(t)=e^{-t}(u(t)-u(t-1))$$"></p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq15296554000772663939.png" alt="$$g(t)= t(u(t+1)-u(t-1))$$"></p><p><img vspace="5" hspace="5" src="conv1.PNG" alt=""> </p><p>Nuestras funci&oacute;nes a aplicarles convoluci&oacute;n son:</p><pre class="codeinput">f=@(t) exp(-t).*(heaviside(t)-heaviside(t-1));
g=@(t) t.*(heaviside(t+1)-heaviside(t-1));
</pre><p>y la se&ntilde;al anal&iacute;tica de convoluci&oacute;n que obtuvimos con los c&aacute;lulculos es:</p><pre class="codeinput">r=@(t) (-1+2*exp(-1-t)+t).*(-1&lt;=t &amp; t&lt;0) +((2+exp(1).*(t-1)-t)/exp(1)).*(0&lt;=t &amp; t&lt;1)+((2-t)/exp(1)).*(1&lt;=t &amp; t&lt;2);
</pre><p>Nuestra funci&oacute;n convconm necesita distintos parametros de entrada: convconm(x,h,i1,f1,i2,f2,f) Donde:</p><div><ul><li>x es la se&ntilde;al x(t)</li><li>h es a se&ntilde;al h(t)</li><li>i1 es el punto de inicio de x(t)</li><li>f1 es el punto final de x(t)</li><li>i2 es el punto de inicio de h(t)</li><li>f2 es el punto final de h(t)</li><li>f es la se&ntilde;al anal&iacute;tica de convoluci&oacute;n</li></ul></div><p>A&ntilde;adimos como parametro la funci&oacute;n anal&iacute;tica para validar los resultados obtenidos con los c&aacute;lculos hechos y la se&ntilde;al obtenida por la funci&oacute;n de convoluci&oacute;n.</p><p>Aplicando Convoluci&oacute;n:</p><pre class="codeinput">convconm(f,g,0,1,-1,1,r)
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_02.png" alt=""> <p>El proceso de convoluci&oacute;n se ve como:</p><p><img vspace="5" hspace="5" src="convocontinua1.gif" alt=""> </p><h2 id="23">Punto 2: Ejercicio e) de la PR05</h2><p>Para el PR05 reporte la grafica de la simulaci&oacute;n n&uacute;merica de la correalci&oacute;n y compare con el resultado an&aacute;litico que obtuvo para el problema e), esto es, su pr&aacute;ctica tendr&aacute; que incluir una llamada a la funci&oacute;nn convconm y posteriormente se tendr&aacute; que mostrar (mediante el Publish) la gr&aacute;fica tanto de las se&ntilde;ales involucradas como el resultado de su correlaci&oacute;n, y en esta &uacute;ltima graficara su resultado analitico, se tendr&aacute; que incluir el resultado analitico.</p><p>e) Realiza la auto correlaci&oacute;n de</p><p><img src="ASySPracP04CarlosJosafathLopezFavila_eq12915237637791323363.png" alt="$$x(t)=u(t)-2u(t-3)+u(t-4)$$"></p><p>Definici&oacute;n de la funci&oacute;n x(t):</p><pre class="codeinput">x=@(t) heaviside(t)-2*heaviside(t-3)+heaviside(t-4);
<span class="comment">%</span>
<span class="comment">% y por definici&oacute;n definimos x1(t) como x(-t)</span>
<span class="comment">%</span>
x1=@(t) heaviside(-t)-2*heaviside(-t-3)+heaviside(-t-4);
</pre><p>La funci&oacute;n obtenida de forma anal&iacute;tica es:</p><pre class="codeinput">r=@(t) (-t-4).*(-4&lt;=t &amp; t&lt;-3)+(t+2).*(-3&lt;=t &amp; t&lt;-1)+(3*t+4).*(-1&lt;=t &amp; t&lt;0)+(-3*t+4).*(0&lt;=t &amp; t&lt;1)+(-t+2).*(1&lt;=t &amp; t&lt;3)+(t-4).*(3&lt;=t &amp; t&lt;=4);
</pre><p>Y ocupando la funci&oacute;n convconm:</p><pre class="codeinput">convconm(x,x1,0,4,-4,0,r)
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_03.png" alt=""> <p><img vspace="5" hspace="5" src="convocontinua2.gif" alt=""> </p><h2 id="30">Punto 3 Convoluci&oacute;n de las se&ntilde;ales (c) con (d) del problema 3.1-1</h2><pre class="codeinput">clear;
n=-3:3;
a=3.*n;
b=[0 4 2 0 2 4 0];
subplot(1,2,1)
stem(a);
subplot(1,2,2)
stem(b);
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_04.png" alt=""> <p>El resultado teorico nos da:</p><pre class="codeinput">C=[0 -36 -42 -24 -24 -36  0 36 24 24 42 36 0];
figure
stem(-6:6,C)
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_05.png" alt=""> <pre class="codeinput">convdisc([n;a],[n;b],C);
clc;
clear;
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_06.png" alt=""> <img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_07.png" alt=""> <img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_08.png" alt=""> <p><img vspace="5" hspace="5" src="P04_4.png" alt=""> </p><p>El proceso de convoluci&oacute;n se ve como:</p><p><img vspace="5" hspace="5" src="ConvDis1.gif" alt=""> </p><h2 id="36">Punto 4 Correlacion de las se&ntilde;ales (c) con (d) del problema 3.1-1</h2><pre class="codeinput">n=-3:3;
a=3.*n;
b=[0 4 2 0 2 4 0];
c=fliplr(b);
subplot(1,2,1)
stem(a);
subplot(1,2,2)
stem(c);
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_09.png" alt=""> <p>El resultado teorico nos da:</p><pre class="codeinput">C=[0 -36 -42 -24 -24 -36  0 36 24 24 42 36 0];
figure
stem(-6:6,C)
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_10.png" alt=""> <pre class="codeinput">convdisc([n;a],[n;c],C)
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_11.png" alt=""> <img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_12.png" alt=""> <p><img vspace="5" hspace="5" src="P04_5.png" alt=""> </p><p>El proceso de convoluci&oacute;n se ve como:</p><p><img vspace="5" hspace="5" src="CorrDis1.gif" alt=""> </p><h2 id="42">Punto 5 Convolucion de las se&ntilde;ales (c) con (d) del problema 3.1-1 usando CONV</h2><pre class="codeinput">n=-3:3;
a=3.*n;
b=[0 4 2 0 2 4 0];
x=conv(a,b);
subplot(1,3,1)
stem(n,a)
subplot(1,3,2)
stem(n,b)
subplot(1,3,3)
stem(-6:6,x)
<span class="comment">%</span>
</pre><img vspace="5" hspace="5" src="ASySPracP04CarlosJosafathLopezFavila_13.png" alt=""> <h2 id="43">Ap&eacute;ndices</h2><pre class="codeinput"><span class="keyword">function</span> convconm(x,h,i1,f1,i2,f2,f)
<span class="comment">%i1 es el punto de inicio en t de la se&ntilde;al x(t)</span>
<span class="comment">%f1 es el punto final en t de la se&ntilde;al x(t)</span>
<span class="comment">%i2 es el punto de inicio en t de la se&ntilde;al h(t)</span>
<span class="comment">%f2 es el punto final en t de la se&ntilde;al h(t)</span>
<span class="comment">%f es la se&ntilde;al del resultado anal&iacute;tico obtenido</span>

T1=f1-i1;<span class="comment">%intervalo de la primer se&ntilde;al finita</span>
  T2=f2-i2;<span class="comment">%intervalo de la segunda se&ntilde;al finita</span>
  figure (1) <span class="comment">% Se crea una figura para hacer las gr&aacute;ficas</span>
  dtau = 0.005; <span class="comment">% Base de los rectangulos para realizar la integral</span>
  tau = i1+i2-1:dtau:f1+f2+0.5; <span class="comment">% Intervalo de visualizaci&oacute;n del resultado</span>
  ti = 0; <span class="comment">% Indice para el vector de resultados</span>
  tvec = i1+i2-0.5:.1:f1+f2+0.5; <span class="comment">% traslaciones de t, cuantas integrales se calculan</span>
  y = NaN*zeros(1, length (tvec)); <span class="comment">% Resultados de acuerdo a cuantos t</span>

  <span class="comment">% encuentra valores m&aacute;ximos y minimos de las funciones para los limites</span>
  <span class="comment">% de graficaci&oacute;n</span>
  l=i1+i2:0.1:f1+f2;
  A=x(l);
  B=h(l);
  C=f(l);
  max1=max(A);
  max2=max(B);
  max3=max(C);
  min1=min(A);
  min2=min(B);
  min3=min(C);

  hFig = figure(1);
  set(hFig, <span class="string">'Position'</span>, [0 0 1000 1000])
  filename = <span class="string">'convocontinua.gif'</span>;
  ttt=1;
  <span class="keyword">for</span> t = tvec <span class="comment">% Cantidad de traslaciones</span>
      ti = ti+1; <span class="comment">% Indice para guardar el resultado (indice del tiempo)</span>
      xh = x(t-tau).*h(tau); <span class="comment">% resultado de la multiplicaci&oacute;n</span>
      lxh = length(xh); <span class="comment">% longitud del resultado</span>
      y(ti) = sum(xh.*dtau); <span class="comment">% Base por altura, aproximaci&oacute;n de la integral</span>
      subplot (3,1,1), <span class="comment">% gr&aacute;fica de 2 x 1 (primera)</span>
      plot(tau, h(tau), <span class="string">'r-'</span>, t, 0, <span class="string">'ob'</span>); <span class="comment">%graficas</span>
      axis ([tau(1) tau(end) min2-1 max2+1]); <span class="comment">% l&iacute;mites de los ejes</span>
      patch([tau(1:end-1); tau(1:end-1); tau(2:end); tau(2:end)],<span class="keyword">...</span>
      [zeros(1,lxh-1);xh(1:end-1);xh(2:end);zeros(1,lxh-1)],<span class="keyword">...</span>
      [.8 .8 .8], <span class="string">'edgecolor'</span>, <span class="string">'none'</span>);
      xlabel(<span class="string">'\tau'</span>); <span class="comment">% Texto del eje X</span>
      legend(<span class="string">'h(\tau)'</span>,<span class="string">'t'</span>, <span class="string">'h(\tau)x(t-\tau)'</span>)<span class="comment">% Caja de Texto</span>
      subplot(3,1,2)
      plot(tau, x(t-tau), <span class="string">'g--'</span>); <span class="comment">%grafica funci&oacute;n m&oacute;vil</span>
      axis ([tau(1) tau(end) min1-1 max1+1]); <span class="comment">% l&iacute;mites de los ejes</span>
      xlabel(<span class="string">'\tau'</span>); <span class="comment">% Texto del eje X</span>
      legend( <span class="string">'x(t-\tau)'</span>)<span class="comment">% Caja de Texto</span>
      subplot (3, 1, 3)  <span class="comment">% gr&aacute;fica de 2 x 1 (segunda)</span>
      plot (tau,f(tau),<span class="string">'b'</span>,tvec, y, <span class="string">'k'</span>, tvec (ti), y(ti), <span class="string">'ok'</span>);
      xlabel (<span class="string">'t'</span>);
      ylabel (<span class="string">'y(t) = \int h(\tau)x(t-\tau) d\tau'</span>);
      axis ([tau(1) tau(end) min3-1 max3+1]); <span class="comment">% l&iacute;mites del eje</span>
      grid; <span class="comment">% malla</span>
      drawnow; <span class="comment">% efecto de movimiento continuo</span>
      frame = getframe(hFig);
      im = frame2im(frame);
      [imind,cm] = rgb2ind(im,256);
      <span class="comment">% Write to the GIF File</span>
        <span class="keyword">if</span> ttt == 1
          imwrite(imind,cm,filename,<span class="string">'gif'</span>, <span class="string">'Loopcount'</span>,inf);
        <span class="keyword">else</span>
          imwrite(imind,cm,filename,<span class="string">'gif'</span>,<span class="string">'WriteMode'</span>,<span class="string">'append'</span>);
        <span class="keyword">end</span>
        ttt=ttt+1;
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="keyword">function</span> convdisc(x1,x2,x4)
    Tam1 = size(x1(1,:));
    Tam2 = size(x2(1,:));
    T1 = Tam1(2);
    T2 = Tam2(2);
    T3 = T1+T2-1;
    vec1 = zeros(1,T1+2*T2-2);
    vec2 = zeros(1,T1+2*T2-2);
    Tec2 = -(T2-1):(T1+T2-2);
    size(vec2);
    size(Tec2);
    x3=zeros(2,T3);
    x3(1,:)=0:T3-1;
    x3(1,:)=x3(1,:)+x1(1,1)+x2(1,1);
    vec1(1,T2:T2+T1-1)=x1(2,:);
    figure (1)
    hFig = figure(1);
    set(hFig, <span class="string">'Position'</span>, [0 0 1000 1000])
    filename = <span class="string">'testAnimated.gif'</span>;
    ttt=1;
    <span class="keyword">for</span> m=0:T1+T2-2
        vec2(1,1+m:T2+m)=fliplr(x2(2,:));
        x3(2,m+1)=sum(vec1.*vec2);
        subplot(4,1,4)
        stem(x3(1,:),x4,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,3)
        hold <span class="string">on</span>
        subplot(4,1,4)
        stem(x3(1,:),x3(2,:),<span class="string">'r'</span>,<span class="string">'LineWidth'</span>,3)
        axis([Tec2(1),T1+2*T2-2,  min(x3(2,:))-1 max(x3(2,:))+1])
        ylim(<span class="string">'auto'</span>)
        ylabel(<span class="string">'x_3[n]'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        xlabel(<span class="string">'n'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        grid <span class="string">on</span>
        subplot(4,1,1)
        stem(x2(1,:),x2(2,:),<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,3)
        ylabel(<span class="string">'x_2[m]'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        xlabel(<span class="string">'m'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        title(<span class="string">'CONVOLUCI&oacute;N'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        grid <span class="string">on</span>
        axis([Tec2(1),T1+2*T2-2, min(x2(2,:))-1 max(x2(2,:))+1])
        ylim(<span class="string">'auto'</span>)
        subplot(4,1,2)
        stem(x1(1,:),x1(2,:),<span class="string">'b'</span>,<span class="string">'LineWidth'</span>,3)
        ylabel(<span class="string">'x_1[m]'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        xlabel(<span class="string">'m'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        grid <span class="string">on</span>
        axis([Tec2(1),T1+2*T2-2, min(x1(2,:))-1 max(x1(2,:))+1])
        ylim(<span class="string">'auto'</span>)
        subplot(4,1,3)
        stem(Tec2,vec2(1,:),<span class="string">'g'</span>,<span class="string">'LineWidth'</span>,3)
        axis([Tec2(1),T1+2*T2-2,min(vec2)-1, max(vec2)+1 ])
        ylim(<span class="string">'auto'</span>)
        ylabel(<span class="string">'x_2[n-m]'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        xlabel(<span class="string">'m'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        grid <span class="string">on</span>
        drawnow;
        pause(0.1)
        vec2 = zeros(1,T1+2*T2-2);
        frame = getframe(hFig);
        im = frame2im(frame);
        [imind,cm] = rgb2ind(im,256);
        <span class="comment">% Write to the GIF File</span>
        <span class="keyword">if</span> ttt == 1
          imwrite(imind,cm,filename,<span class="string">'gif'</span>, <span class="string">'Loopcount'</span>,inf);
        <span class="keyword">else</span>
          imwrite(imind,cm,filename,<span class="string">'gif'</span>,<span class="string">'WriteMode'</span>,<span class="string">'append'</span>);
        <span class="keyword">end</span>
        ttt=ttt+1;
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% *P04: Convolución y Correlación de señales*
%
% *INTEGRANTES:*
%
% * Carlos Josafath López Favila
% * Iván Rodrigo Santacruz Bravo
%% *OBJETIVOS*
%
% * Conocer métodos básicos de integración numérica
% * Manipulación de instrucciones en MATLAB
% * Simular convoluciones y correlaciones de señales continuas
% * Simular convoluciones y correlaciones de señales discretas
%% *INTRODUCCIÓN*
% *Mètodos Numèricos*
% Cuando aplicamos la teoria del calculo en la realidad se pueden dar casos 
% donde se tengan problemas cuya solucion no pueda ser encontrada por alguna formula 
% o mètodo del calculo, es por ello que los matematicos se dieron a la tarea de 
% desarrollar los *métodos numéricos.* Se trata de una serie de cálculos para 
% acercarnos lo más posible a una solución numérica con una precisión razonablemente 
% buena. Los *métodos numéricos* son utilizados en ingeniería para facilitar la 
% resolución de problemas que conllevan una enorme cantidad de cálculos, lo que 
% permite ahorrar tiempo.
%
% *Teorema fundamental del Cálculo*
%
% El teorema dice asi "Si f(x) es integrable y $\frac{\mathrm{d} F(x)}{\mathrm{d} 
% x}=f(x)$ entonces:
% 
% $$\int_{a}^{b}f(x)dx=F(b)-F(a)$$
% 
% En este mètodo se centra en encontrar aproximaciones a integrales de funciones 
% que no son posibles de resolver por algun mètodo conocido, como por ejemplo:
% 
% $$f(x)= e^{-x^{2}}$$
% 
% $$\int_{-1}^{1} f(x)dx=\int_{-1}^{1}e^{-x^{2}}dx$$

syms t;
ft = exp(-t^2);
fplot(ft);
title('f(t)');
grid on
clear ;
clc;
%% 
% Como no es posible encontrar F(x) entonces se procede a hacer una aproximacion 
% con un polinomio
% 
% Con P(x)=1                    entonces $\int_{-1}^{1}P(x)dx=\int_{-1}^{1}1dx=2$     
% 
% Tenemos la siguiente Gràfica
% 
% <<P04_1.jpeg>>
% 
% Donde el àrea sobreada de color naraja es el àrea de P(x) y el àrea en color 
% verde seria el àrea de f(x)
% 
% Teniendo esto podemos decir con seguiridad que $\int_{-1}^{1}e^{-x^{2}}dx<2$ 
% 
% Y podemos dividir el rectàngulo generado por el area de P(x) en 4 y hacer
% una aproximacion mas acertada $\int_{-1}^{1}e^{-x^{2}}dx\approx 1.4936$
%%
% **Fòrmulas Cerradas de Newton-Cotes**
%
% En este mètodo se utilizan los polinomios de interpolacion de Lagrange
% para determinar $\int_{a}^{b}f(x)dx$
%
% Establece que $f(x)^{n+1}\epsilon [a,b]$ existe $\varepsilon (x)\epsilon[a,b]$
%
% Donde f(x) se puede escribir como:
%
% $$f(x)=P_{n}(x)+\frac{f(x)^{n+1}(\varepsilon(x))}{(n+1)!}(x-x_{0})(x-x_{1})...(x-x_{n})$$
%
% Donde $P_{n}$ seria una aproximacion a la funcion mas un termino de error
% , $x_{0}=a$, $x_{n}=b$, $x_{n}=a$, $h=\frac{b-a}{n}$, $x_{i}=a+ih$, 
% $i= 0,1,...,n$ , $n$ es el grado del polinomio 
%
% Para que de este modo en lugar de determinar la integral de f(x), se hace
% una aproximacion por medio de los polinomios de lagrange
%
%%
% *Regla del trapecio*
%
% Este mètodo es el mètodo de Newton-Cotes para un valor de $n=1$ que nos
% da la siguiente fòrmula:
%
% $$\int_{x_{0}}^{x_{1}}f(x)dx= \frac{h}{2}[f(x_{0})+f(x_{1})]-\frac{h^{3}}{12}f^{''}(\varepsilon )$$
%
% Donde $x_{0}<\varepsilon <x_{1}$
%
% Retomando el ejemplo anterior
%
% Para Resolver $\int_{-1}^{1} e^{-x^{2}}dx$
%
% se tiene que
% $$\int_{-1}^{1}e^{-x^{2}}dx= \frac{2}{2}[e^{-1}+e^{-1}]-\frac{8}{12}f^{''}(\varepsilon )$
%
syms t E
ft=exp(-t^2);
d2ft=diff(ft,2);
FT=matlabFunction(ft);
n=1;
a=-1;
b=1;
x0=a;
x1=b;
h=(b-a)/n;
i=0:1:n;
xi=a+i*h;
int=(h/2)*(FT(x0)+FT(x1))
INT=round(int,4)-((h^3)/12)*subs(d2ft,t,E)
clc;
clear;
%%
% Donde se tiene que $-\frac{8}{12}f^{''}(\varepsilon )$ es el tèrmino de
% error que se debe de sumar o restar a la aproximacion con $-1<\varepsilon <1$
%
% *Regla de Simpson*
%
% Cuando se tiene que n=2 en el mètodo de Newton-Cotes se le denomina Regla
% de Simpson
%
% $$\int_{x_{0}}^{x_{2}}f(x)dx= \frac{h}{3}[f(x_{0})+4f(x_{1})+f(x_{2})]-\frac{h^{5}}{90}f^{4'}(\varepsilon$$
%
% Donde   $x_{0}<\varepsilon <x_{2}$
%
% Aplicando la Regla de simpson para encontrar la aproximación de $\int_{-1}^{1}e^{-x^{2}}dx$
%
% $$\int_{-1}^{1}e^{-x^{2}}dx= \frac{h}{3}[e^{-1}+4e^{0}+e^{-1}]-\frac{32}{90}f^{4'}(\varepsilon)$$
%
%
syms t E
ft=exp(-t^2);
d2ft=diff(ft,4);
FT=matlabFunction(ft);
n=2;
a=-1;
b=1;
h=(b-a)/n;
i=0:1:n;
I=length(i);
x0=a;
x1=a+(h*i(I-1));
x2=b;
int=(h/3)*(FT(x0)+4*FT(x1)+FT(x2))
INT=round(int,4)-((h^5)/90)*subs(d2ft,t,E)
clear;
clc;
%% 
%
% Donde se tiene que $-\frac{32}{90}f^{4'}(\varepsilon)$ es el tèrmino de
% error que se debe de sumar o restar a la aproximación con $-1<\varepsilon <1$
%
%%
% 
%%
% 
% *Regla de 3/8 de Simpson*
%
% Cuando de realiza una interpolacion para obtener una aproximacion con un
% polinomio de 3er grado se le llama como regla de 3/8 de Simpson que nos
% da la siguiente fòrmula
%
% $$\int_{x_{0}}^{x_{3}}f(x)dx= \frac{3}{8}h[f(x_{0})+3f(x_{1})+3f(x_{2})+f(x_{3})]-\frac{3h^{5}}{80}f^{4'}(\varepsilon)$$
%
% Donde   $x_{0}<\varepsilon <x_{3}$
%
% Aplicando la Regla de simpson para encontrar la aproximacion de
% $\int_{-1}^{1}e^{-x^{2}}dx$ se tiene:
%
% $$\int_{-1}^{1}e^{-x^{2}}dx=\frac{3}{8}\frac{2}{3}[e^{-1}+3e^{-\frac{1}{9}}+3e^{-\frac{1}{9}}+e^{-1}]-\frac{3(\frac{2}{3})^{5}}{80}f^{4'}(\varepsilon)$$
%
%
syms t E
ft=exp(-t^2);
d2ft=diff(ft,4);
FT=matlabFunction(ft);
n=3;
a=-1;
b=1;
h=(b-a)/n;
i=0:1:n;
I=length(i);
x0=a;
x1=a+(h*i(I-1));
x2=a+(h*i(I-2));
x3=b;
int=((3*h)/8)*(FT(x0)+3*FT(x1)+3*FT(x2)+FT(x3))
INT=round(int,4)-((3*(h^5))/80)*subs(d2ft,t,E)
clear
clc;
%%
%
% Donde se tiene que $-\frac{3(\frac{2}{3})^{5}}{80}f^{4'}(\varepsilon)$ es el tèrmino de
% error que se debe de sumar o restar a la aproximacion con $-1<\varepsilon <1$
%
% *Regla del trapecio compuesta*
%
% La idea de este metodo es dividir el intervalo principal en $n$
% intervalos para obtener una mejor aproximacion
%
% $$\int_{a}^{b}f(x)dx= \frac{h}{2}[f(a)+2\sum_{j=1}^{n-1}f(x_{j})+f(b)]-\frac{{b-a}}{12}h^{2}f^{''}(\mu)$$
%
% Donde $\mu\epsilon [a,b]$, $h=\frac{b-a}{n}$, $n$ es el nùmero de 
% subintervalos, $x_{j}=a+jh$  y $j=1,2,3,...,n$
%
% EJEMPLO
%
% Retomando el ejercicio inicial y realizando 10 subintervalos tenemos que:
%
% $$\int_{-1}^{1}e^{-x^{2}}dx=\frac{0.2}{2}[e^{-1}+2\sum_{j=1}^{9}e^{-x_{j}^{2}}+e^{-1}]-\frac{2}{12}(0.2)^{2}f^{''}(\mu)$$
syms t u
ft=exp(-t^2);
d2ft=diff(ft,2);
FT=matlabFunction(ft);
n=10;
a=-1;
b=1;
j=1:(n-1);
h=(b-a)/n;
xj=a+(j*h);
int= (h/2)*(FT(a)+2*sum(FT(xj))+FT(b))
INT= round(int,4)-((b-a)/12)*(h^2)*subs(d2ft,t,u)
clear
clc
%%
% Donde $-\frac{2}{12}(0.2)^{2}f^{''}(\mu)$ es el tèrmino de error y $-1<\mu<1$
%
% *Regla de Simpson compuesta*
%
% Es la misma idea de la regla de simpson pero con el formato de la regla
% del trapecio compuesta (dividir en subintervalos)
%
% Pero con la condicion de que el nùmero de subintervalos sea par teniendo
% asi lo siguiente:
%
% $\int_{a}^{b}f(x)dx= \frac{h}{3}[f(a)+2\sum_{j=1}^{\frac{n}{2}-1}f(x_{2j})+4\sum_{j=1}^{\frac{n}{2}}f(x_{2j-1})+f(b)]-\frac{{b-a}}{180}h^{4}f^{4'}(\mu)$
%
% Donde $\mu\epsilon [a,b]$, $h=\frac{b-a}{n}$, $n$ es el nùmero de 
% subintervalos, $x_{j}=a+jh$  y $j=1,2,3,...,n$
% EJEMPLO
%
% Retomando el ejercicio inicial y realizando 10 subintervalos tenemos que:
%
% $$\int_{-1}^{1}e^{-x^{2}}dx=\frac{0.2}{3}[e^{-1}+2\sum_{j=1}^{4}e^{-x_{2j}^{2}}+4\sum_{j=1}^{5}e^{-x_{2j-1}^{2}})+e^{-1}]-\frac{2}{180}(0.2)^{4}f^{4'}(\mu)$$
%
%
syms t u
ft=exp(-t^2);
d2ft=diff(ft,4);
FT=matlabFunction(ft);
n=10;
a=-1;
b=1;
ji=1:2:(n-1);
jp=2:2:(n-1);
h=(b-a)/n;
xjp=a+(jp*h);
xji=a+(ji*h);
int= (h/3)*(FT(a)+2*sum(FT(xjp))+4*sum(FT(xji))+FT(b))
INT= round(int,4)-((b-a)/180)*(h^2)*subs(d2ft,t,u)
%%
%
% Donde $-\frac{2}{180}(0.2)^{4}f^{4'}(\mu)$ es el tèrmino de error y $-1<\mu<1$
%
% *Cuadratura Gaussiana*
%
% En este mètodo se usa los polinomios de legendre para encontrar una
% aproximacion a la integral en un valor determinado de tal manera que:
%
% $$\int_{a}^{b}f(x)dx\approx \sum_{i=1}^{n} C_{i}f(x_{i})$$
% 
% Donde $C_{i}$ son las raices del polinomio de,Legendre
%
% Los polinomios de legendre estan definidos como:
%
% $$P_{n}(t)=\frac{1}{n!2^{n}}\frac{\mathrm{d^{n}} }{\mathrm{d}t^{n}}(t^{2}-1)^{n}$$
%
% Y la formula se reduce a la suma de la funcion evaluada en en
% coeficiente de legendre multiplicado por las raices del polinomio al que
% se aproximo
% 
% <<P04_2.jpeg>>
%
% EJEMPLO 
% Si se quiere encontrar $\int_{-1}^{1}e^{-x^{2}}dx$ con una aproximacion
% al polinomio de legendre de grado 2 entonces:
syms t 
ft=exp(-t^2);
FT=matlabFunction(ft);
Cnj=[1,1];
rnj=[0.5773502692,-0.5773502692];
Frnj=FT(rnj);
Aprox=sum(Cnj.*Frnj)
clear
clc;
%%
%
%Si se quiere encontrar $\int_{-1}^{1}e^{-x^{2}}dx$ con una aproximacion
% al polinomio de legendre de grado 3 entonces:
%
syms t 
ft=exp(-t^2);
FT=matlabFunction(ft);
rnj=[0.7745966692,0,-0.7745966692];
Cnj=[0.55555555555556,0.888888888889,0.55555555555556];
Frnj=FT(rnj);
Aprox=sum(Cnj.*Frnj)
clear
clc;


%% Punto 1: Ejercicio 1 de la PR04
% Para el PR04 reporte la grafica de la simulación númerica de la 
% convolución y compare con el resultado análitico que obtuvo para el problema 1, 
% esto es, su práctica tendrá que incluir una llamada a la funciónn convconm 
% y posteriormente se tendrá que mostrar (mediante el Publish) la gráfica 
% tanto de las señales involucradas como el resultado de la convolución, y 
% en esta última gráficara su resultado analitico, se tendrá que incluir el 
% resultado analitico.
% Realizamos la convolución de dos señales:
% 
% 
% $$f(t)=e^{-t}(u(t)-u(t-1))$$
% 
% $$g(t)= t(u(t+1)-u(t-1))$$
% 
% <<conv1.PNG>>
%%
% Nuestras funciónes a aplicarles convolución son:
%%
f=@(t) exp(-t).*(heaviside(t)-heaviside(t-1));
g=@(t) t.*(heaviside(t+1)-heaviside(t-1));
%%
% y la señal analítica de convolución que obtuvimos con los cálulculos es:
%%
r=@(t) (-1+2*exp(-1-t)+t).*(-1<=t & t<0) +((2+exp(1).*(t-1)-t)/exp(1)).*(0<=t & t<1)+((2-t)/exp(1)).*(1<=t & t<2);
%%
% Nuestra función convconm necesita distintos parametros de entrada:
% convconm(x,h,i1,f1,i2,f2,f)
% Donde:
% 
% * x es la señal x(t)
% * h es a señal h(t)
% * i1 es el punto de inicio de x(t)
% * f1 es el punto final de x(t)
% * i2 es el punto de inicio de h(t)
% * f2 es el punto final de h(t)
% * f es la señal analítica de convolución
% 
%
% Añadimos como parametro la función analítica para validar los resultados
% obtenidos con los cálculos hechos y la señal obtenida por la función de
% convolución.
% 
% 
% Aplicando Convolución:
%%
convconm(f,g,0,1,-1,1,r)
%%
% El proceso de convolución se ve como:
%%
% 
% <<convocontinua1.gif>>
%% Punto 2: Ejercicio e) de la PR05
%
% Para el PR05 reporte la grafica de la simulación númerica de la correalción 
% y compare con el resultado análitico que obtuvo para el problema e), 
% esto es, su práctica tendrá que incluir una llamada a la funciónn convconm 
% y posteriormente se tendrá que mostrar (mediante el Publish) la gráfica 
% tanto de las señales involucradas como el resultado de su correlación, y 
% en esta última graficara su resultado analitico, se tendrá que incluir el 
% resultado analitico.
%
% e) Realiza la auto correlación de 
%%
% $$x(t)=u(t)-2u(t-3)+u(t-4)$$
% 
%%
% Definición de la función x(t):
x=@(t) heaviside(t)-2*heaviside(t-3)+heaviside(t-4);
%
% y por definición definimos x1(t) como x(-t)
%
x1=@(t) heaviside(-t)-2*heaviside(-t-3)+heaviside(-t-4);
%%
% La función obtenida de forma analítica es:
r=@(t) (-t-4).*(-4<=t & t<-3)+(t+2).*(-3<=t & t<-1)+(3*t+4).*(-1<=t & t<0)+(-3*t+4).*(0<=t & t<1)+(-t+2).*(1<=t & t<3)+(t-4).*(3<=t & t<=4);
%%
% Y ocupando la función convconm:
%%
convconm(x,x1,0,4,-4,0,r)
%%
% 
% <<convocontinua2.gif>>
% 

%% Punto 3 Convolución de las señales (c) con (d) del problema 3.1-1
%
clear;
n=-3:3;
a=3.*n;
b=[0 4 2 0 2 4 0];
subplot(1,2,1)
stem(a);
subplot(1,2,2)
stem(b);
%%
% El resultado teorico nos da:
C=[0 -36 -42 -24 -24 -36  0 36 24 24 42 36 0];
figure
stem(-6:6,C)
%%
convdisc([n;a],[n;b],C);
clc;
clear;
%%
% 
% <<P04_4.png>>
%%
% El proceso de convolución se ve como:
%%
% 
% <<ConvDis1.gif>>
% 
%% Punto 4 Correlacion de las señales (c) con (d) del problema 3.1-1
%
n=-3:3;
a=3.*n;
b=[0 4 2 0 2 4 0];
c=fliplr(b);
subplot(1,2,1)
stem(a);
subplot(1,2,2)
stem(c);
%%
% El resultado teorico nos da:
C=[0 -36 -42 -24 -24 -36  0 36 24 24 42 36 0];
figure
stem(-6:6,C)
%%
convdisc([n;a],[n;c],C)
%%
% <<P04_5.png>>
%%
% El proceso de convolución se ve como:
%%
% 
% <<CorrDis1.gif>>
% 
%
%
%% Punto 5 Convolucion de las señales (c) con (d) del problema 3.1-1 usando CONV
%
n=-3:3;
a=3.*n;
b=[0 4 2 0 2 4 0];
x=conv(a,b);
subplot(1,3,1)
stem(n,a)
subplot(1,3,2)
stem(n,b)
subplot(1,3,3)
stem(-6:6,x)
%
%% Apéndices
function convconm(x,h,i1,f1,i2,f2,f)
%i1 es el punto de inicio en t de la señal x(t)
%f1 es el punto final en t de la señal x(t)
%i2 es el punto de inicio en t de la señal h(t)
%f2 es el punto final en t de la señal h(t)
%f es la señal del resultado analítico obtenido

T1=f1-i1;%intervalo de la primer señal finita
  T2=f2-i2;%intervalo de la segunda señal finita
  figure (1) % Se crea una figura para hacer las gráficas
  dtau = 0.005; % Base de los rectangulos para realizar la integral 
  tau = i1+i2-1:dtau:f1+f2+0.5; % Intervalo de visualización del resultado
  ti = 0; % Indice para el vector de resultados
  tvec = i1+i2-0.5:.1:f1+f2+0.5; % traslaciones de t, cuantas integrales se calculan  
  y = NaN*zeros(1, length (tvec)); % Resultados de acuerdo a cuantos t
  
  % encuentra valores máximos y minimos de las funciones para los limites
  % de graficación
  l=i1+i2:0.1:f1+f2;
  A=x(l);
  B=h(l);
  C=f(l);
  max1=max(A);
  max2=max(B);
  max3=max(C);
  min1=min(A);
  min2=min(B);
  min3=min(C);
  
  hFig = figure(1);
  set(hFig, 'Position', [0 0 1000 1000])
  filename = 'convocontinua.gif';
  ttt=1;
  for t = tvec % Cantidad de traslaciones
      ti = ti+1; % Indice para guardar el resultado (indice del tiempo)
      xh = x(t-tau).*h(tau); % resultado de la multiplicación 
      lxh = length(xh); % longitud del resultado
      y(ti) = sum(xh.*dtau); % Base por altura, aproximación de la integral
      subplot (3,1,1), % gráfica de 2 x 1 (primera)
      plot(tau, h(tau), 'r-', t, 0, 'ob'); %graficas 
      axis ([tau(1) tau(end) min2-1 max2+1]); % límites de los ejes
      patch([tau(1:end-1); tau(1:end-1); tau(2:end); tau(2:end)],...
      [zeros(1,lxh-1);xh(1:end-1);xh(2:end);zeros(1,lxh-1)],...
      [.8 .8 .8], 'edgecolor', 'none');
      xlabel('\tau'); % Texto del eje X
      legend('h(\tau)','t', 'h(\tau)x(t-\tau)')% Caja de Texto
      subplot(3,1,2)
      plot(tau, x(t-tau), 'gREPLACE_WITH_DASH_DASH'); %grafica función móvil
      axis ([tau(1) tau(end) min1-1 max1+1]); % límites de los ejes
      xlabel('\tau'); % Texto del eje X
      legend( 'x(t-\tau)')% Caja de Texto
      subplot (3, 1, 3)  % gráfica de 2 x 1 (segunda)
      plot (tau,f(tau),'b',tvec, y, 'k', tvec (ti), y(ti), 'ok');
      xlabel ('t'); 
      ylabel ('y(t) = \int h(\tau)x(t-\tau) d\tau');
      axis ([tau(1) tau(end) min3-1 max3+1]); % límites del eje
      grid; % malla
      drawnow; % efecto de movimiento continuo
      frame = getframe(hFig); 
      im = frame2im(frame); 
      [imind,cm] = rgb2ind(im,256);
      % Write to the GIF File 
        if ttt == 1 
          imwrite(imind,cm,filename,'gif', 'Loopcount',inf); 
        else 
          imwrite(imind,cm,filename,'gif','WriteMode','append'); 
        end
        ttt=ttt+1;
  end
end
  
function convdisc(x1,x2,x4)
    Tam1 = size(x1(1,:));
    Tam2 = size(x2(1,:));
    T1 = Tam1(2);
    T2 = Tam2(2);
    T3 = T1+T2-1;
    vec1 = zeros(1,T1+2*T2-2);
    vec2 = zeros(1,T1+2*T2-2);
    Tec2 = -(T2-1):(T1+T2-2);
    size(vec2);
    size(Tec2);
    x3=zeros(2,T3);
    x3(1,:)=0:T3-1;
    x3(1,:)=x3(1,:)+x1(1,1)+x2(1,1);
    vec1(1,T2:T2+T1-1)=x1(2,:);
    figure (1)
    hFig = figure(1);
    set(hFig, 'Position', [0 0 1000 1000])
    filename = 'testAnimated.gif';
    ttt=1;
    for m=0:T1+T2-2
        vec2(1,1+m:T2+m)=fliplr(x2(2,:));
        x3(2,m+1)=sum(vec1.*vec2);
        subplot(4,1,4)
        stem(x3(1,:),x4,'k','LineWidth',3)
        hold on
        subplot(4,1,4)
        stem(x3(1,:),x3(2,:),'r','LineWidth',3)
        axis([Tec2(1),T1+2*T2-2,  min(x3(2,:))-1 max(x3(2,:))+1])
        ylim('auto')
        ylabel('x_3[n]','FontWeight','bold','FontSize',16);
        xlabel('n','FontWeight','bold','FontSize',16);
        grid on
        subplot(4,1,1)
        stem(x2(1,:),x2(2,:),'k','LineWidth',3)
        ylabel('x_2[m]','FontWeight','bold','FontSize',16);
        xlabel('m','FontWeight','bold','FontSize',16);
        title('CONVOLUCIóN','FontWeight','bold','FontSize',16);
        grid on
        axis([Tec2(1),T1+2*T2-2, min(x2(2,:))-1 max(x2(2,:))+1])
        ylim('auto')
        subplot(4,1,2)
        stem(x1(1,:),x1(2,:),'b','LineWidth',3)
        ylabel('x_1[m]','FontWeight','bold','FontSize',16);
        xlabel('m','FontWeight','bold','FontSize',16);
        grid on
        axis([Tec2(1),T1+2*T2-2, min(x1(2,:))-1 max(x1(2,:))+1])
        ylim('auto')
        subplot(4,1,3)
        stem(Tec2,vec2(1,:),'g','LineWidth',3)
        axis([Tec2(1),T1+2*T2-2,min(vec2)-1, max(vec2)+1 ])
        ylim('auto')
        ylabel('x_2[n-m]','FontWeight','bold','FontSize',16);
        xlabel('m','FontWeight','bold','FontSize',16);
        grid on
        drawnow;
        pause(0.1)
        vec2 = zeros(1,T1+2*T2-2);
        frame = getframe(hFig); 
        im = frame2im(frame); 
        [imind,cm] = rgb2ind(im,256); 
        % Write to the GIF File 
        if ttt == 1 
          imwrite(imind,cm,filename,'gif', 'Loopcount',inf); 
        else 
          imwrite(imind,cm,filename,'gif','WriteMode','append'); 
        end
        ttt=ttt+1;
    end
end



##### SOURCE END #####
--></body></html>